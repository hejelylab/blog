<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="http://localhost:4000/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/blog/" rel="alternate" type="text/html" /><updated>2021-01-26T00:08:58+03:00</updated><id>http://localhost:4000/blog/feed.xml</id><title type="html">Hejely Lab</title><subtitle>Welcome to this blog.</subtitle><author><name>HejelyLab</name></author><entry><title type="html">Was there a timestomping on the analyzed system?</title><link href="http://localhost:4000/blog/2021/01/25/Timestomping.html" rel="alternate" type="text/html" title="Was there a timestomping on the analyzed system?" /><published>2021-01-25T23:50:00+03:00</published><updated>2021-01-25T23:50:00+03:00</updated><id>http://localhost:4000/blog/2021/01/25/Timestomping</id><content type="html" xml:base="http://localhost:4000/blog/2021/01/25/Timestomping.html">&lt;p&gt;What is timestomping?
Timestomping is the ability from an attacker to modify original timestamps of folder/file in order to prevent the investigator from associating these timestamps with an attack period.&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;Master File Table (MFT)
Filesystem usually has an index mechanism where you can see files/directories names in the system and their associated metadata. This includes timestamps.
In NTFS filesystem, each folder/file has one entry in MFT with two different timestamps called $STANDARD_INFORMATION and $FILE_NAME.&lt;/p&gt;

&lt;p&gt;Mainly, standard information attributes are modifiable by users, whereas file name ones tend to be modified by OS.&lt;/p&gt;

&lt;p&gt;MFT Location: Root directory of the drive for example C:$MFT&lt;/p&gt;

&lt;p&gt;MFT Parsing Tools: 
MFTECMD
analyzeMFT.py
Mft2Csv
MFTExplorer
…&lt;/p&gt;

&lt;p&gt;Example:
Let’s check 1st easy challenge (Time Machine) in (incident-response-challenge.com) website and try to solve it.&lt;/p&gt;

&lt;p&gt;Let’s use MFTECmd to parse $MFT file, and then viewing the results using Timeline Explorer&lt;/p&gt;

&lt;p&gt;Link to download these two tools: https://ericzimmerman.github.io/#!index.md&lt;/p&gt;

&lt;p&gt;MFTECmd used command:
MFTECMD.exe -f “$MFT” –csv . –bn MFTOUTPUT.csv&lt;/p&gt;

&lt;p&gt;. means we would like to save the outputted CSV file to the same directory.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;1st Challenge&lt;/p&gt;

&lt;p&gt;The challenge focuses on changes on user’s desktop and the provided evidence is $MFT file; 
therefore, we have parsed the file using MFTECMD. Now, we’ll view the parsed MFT using Timeline Explorer&lt;/p&gt;

&lt;p&gt;Question Screenshot
&lt;img src=&quot;/blog/assets/images/210125-1.png&quot; alt=&quot;first screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Timeline explorer after opening parsed $MFT
&lt;img src=&quot;/blog/assets/images/210125-2.png&quot; alt=&quot;second screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In order to have a better view, we’ll reset column widths (Tools &amp;gt; Rest Column Widths (Ctrl+R))&lt;/p&gt;

&lt;p&gt;Now, we’ll filter to show only the user’s desktop folder as the parent path&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/assets/images/210125-3.png&quot; alt=&quot;third screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/blog/assets/images/210125-4.png&quot; alt=&quot;fourth screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You may notice I’ve brough the attention into mainly two columns which are Created0x10 and Created0x30&lt;/p&gt;

&lt;p&gt;Created0x10 is Standard Info Creation time (easy be tampered with)
Created 0x30 is FileName Creation time (Difficult to be tampered with).
If they differ, TIMESTOMPING might have happened.
Timeline Explorer doesn’t show timestamp in Created0x30 if it has the same date and time of Created0x10 to ease investigator work.&lt;/p&gt;

&lt;p&gt;We can clearly see that FileName Creation Time (Createdx30) is in  the same timeframe other files in the same folder have been created.&lt;/p&gt;

&lt;p&gt;Answer to the challenge
FileName: Mod-File.txt
Time Stamp: 19-01-2020 11:51:19&lt;/p&gt;</content><author><name>HejelyLab</name></author><summary type="html">What is timestomping? Timestomping is the ability from an attacker to modify original timestamps of folder/file in order to prevent the investigator from associating these timestamps with an attack period.</summary></entry></feed>