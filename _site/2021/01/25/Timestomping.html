
<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Was there a timestomping on the analyzed system? | Hejely Lab</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Was there a timestomping on the analyzed system?" />
<meta name="author" content="HejelyLab" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="What is timestomping? Timestomping is the ability from an attacker to modify original timestamps of folder/file in order to prevent the investigator from associating these timestamps with an attack period." />
<meta property="og:description" content="What is timestomping? Timestomping is the ability from an attacker to modify original timestamps of folder/file in order to prevent the investigator from associating these timestamps with an attack period." />
<link rel="canonical" href="http://localhost:4000/blog/2021/01/25/Timestomping.html" />
<meta property="og:url" content="http://localhost:4000/blog/2021/01/25/Timestomping.html" />
<meta property="og:site_name" content="Hejely Lab" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-25T23:50:00+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Was there a timestomping on the analyzed system?" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Was there a timestomping on the analyzed system?","dateModified":"2021-01-25T23:50:00+03:00","datePublished":"2021-01-25T23:50:00+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/2021/01/25/Timestomping.html"},"author":{"@type":"Person","name":"HejelyLab"},"url":"http://localhost:4000/blog/2021/01/25/Timestomping.html","description":"What is timestomping? Timestomping is the ability from an attacker to modify original timestamps of folder/file in order to prevent the investigator from associating these timestamps with an attack period.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/blog/assets/css/style.css?v=08ebd7f87949fc3a3100207d3b837c46d8cfcb87">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="/blog/assets/js/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/blog/assets/css/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

    <div class="wrapper">

      <section>
        <div id="btitle"> <!-- blog title and description-->
          <a href="/blog/"><h1>Hejely Lab</h1></a>
          <p>Welcome to this blog.</p>
          <hr> 
        </div> 
                
        
        <article itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Was there a timestomping on the analyzed system?</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-01-25T23:50:00+03:00" itemprop="datePublished">Jan 25, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>What is timestomping?
Timestomping is the ability from an attacker to modify original timestamps of folder/file in order to prevent the investigator from associating these timestamps with an attack period.</p>

<hr />
<p>Master File Table (MFT)
Filesystem usually has an index mechanism where you can see files/directories names in the system and their associated metadata. This includes timestamps.
In NTFS filesystem, each folder/file has one entry in MFT with two different timestamps called $STANDARD_INFORMATION and $FILE_NAME.</p>

<p>Mainly, standard information attributes are modifiable by users, whereas file name ones tend to be modified by OS.</p>

<p>MFT Location: Root directory of the drive for example C:$MFT</p>

<p>MFT Parsing Tools: 
MFTECMD
analyzeMFT.py
Mft2Csv
MFTExplorer
…</p>

<p>Example:
Let’s check 1st easy challenge (Time Machine) in (incident-response-challenge.com) website and try to solve it.</p>

<p>Let’s use MFTECmd to parse $MFT file, and then viewing the results using Timeline Explorer</p>

<p>Link to download these two tools: https://ericzimmerman.github.io/#!index.md</p>

<p>MFTECmd used command:
MFTECMD.exe -f “$MFT” –csv . –bn MFTOUTPUT.csv</p>

<p>. means we would like to save the outputted CSV file to the same directory.</p>

<hr />

<p>1st Challenge</p>

<p>The challenge focuses on changes on user’s desktop and the provided evidence is $MFT file; 
therefore, we have parsed the file using MFTECMD. Now, we’ll view the parsed MFT using Timeline Explorer</p>

<p>Question Screenshot
<img src="/blog/assets/images/210125-1.png" alt="first screenshot" /></p>

<p>Timeline explorer after opening parsed $MFT
<img src="/blog/assets/images/210125-2.png" alt="second screenshot" /></p>

<p>In order to have a better view, we’ll reset column widths (Tools &gt; Rest Column Widths (Ctrl+R))</p>

<p>Now, we’ll filter to show only the user’s desktop folder as the parent path</p>

<p><img src="/blog/assets/images/210125-3.png" alt="third screenshot" /></p>

<p><img src="/blog/assets/images/210125-4.png" alt="fourth screenshot" /></p>

<p>You may notice I’ve brough the attention into mainly two columns which are Created0x10 and Created0x30</p>

<p>Created0x10 is Standard Info Creation time (easy be tampered with)
Created 0x30 is FileName Creation time (Difficult to be tampered with).
If they differ, TIMESTOMPING might have happened.
Timeline Explorer doesn’t show timestamp in Created0x30 if it has the same date and time of Created0x10 to ease investigator work.</p>

<p>We can clearly see that FileName Creation Time (Createdx30) is in  the same timeframe other files in the same folder have been created.</p>

<p>Answer to the challenge
FileName: Mod-File.txt
Time Stamp: 19-01-2020 11:51:19</p>


  </div><a class="u-url" href="/blog/2021/01/25/Timestomping.html" hidden></a>
</article>


        <hr>
        <span id="footer"> &copy; HejelyLab 2021</span>

      </section>

    </div>

    
  </body>
</html>
